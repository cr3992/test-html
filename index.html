<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agora WebRTC Video Call</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        
        #localVideoContainer,
        #remoteVideoContainer {
            width: 300px;
            height: 200px;
            margin-bottom: 20px;
            overflow: hidden;
            border: 1px solid #ccc;
        }
        
        video {
            width: 100%;
            height: 100%;
        }
        
        #controls {
            display: flex;
            gap: 10px;
        }
        
        #controls button {
            padding: 10px;
            font-size: 16px;
        }
        
    </style>
    <script src="https://cdn.agora.io/sdk/release/AgoraRTCSDK-3.6.1.js"></script>
</head>
<body>
    <div id="localVideoContainer">
        <video id="localVideo" autoplay muted></video>
    </div>
    <div id="remoteVideoContainer">
        <video id="remoteVideo" autoplay></video>
    </div>
    <div id="controls">
        <button id="startButton">Start Call</button>
        <button id="endButton">End Call</button>
    </div>

    <script>
        const agoraAppId = '80f8dce39b6547e08985621deff72f8a'; // Replace with your Agora App ID
        let localStream;
        let remoteStream;
        let agoraClient;

        const localVideo = document.getElementById('localVideo');
        const remoteVideo = document.getElementById('remoteVideo');
        const startButton = document.getElementById('startButton');
        const endButton = document.getElementById('endButton');

        startButton.addEventListener('click', startCall);
        endButton.addEventListener('click', endCall);

        async function startCall() {
            // Create Agora client
            agoraClient = AgoraRTC.createClient({ mode: 'rtc', codec: 'vp8' });

            // Initialize Agora client with your App ID
            await agoraClient.init(agoraAppId);

            // Create a local stream
            localStream = AgoraRTC.createStream({ streamID: 1, audio: true, video: true, screen: false });
            await localStream.init();

            // Play the local stream
            localStream.play('localVideo');

            // Join a channel with a unique name
            await agoraClient.join(null, '9140026966', null, null);

            // Publish the local stream to the channel
            await agoraClient.publish(localStream);

            // Listen for remote streams
            agoraClient.on('stream-added', async (evt) => {
                const remoteStream = evt.stream;
                // Subscribe to the remote stream
                await agoraClient.subscribe(remoteStream);
            });

            agoraClient.on('stream-subscribed', (evt) => {
                const remoteStream = evt.stream;
                // Play the remote stream
                remoteStream.play('remoteVideo');
            });
        }

        function endCall() {
            // Unpublish the local stream and leave the channel
            agoraClient.unpublish(localStream);
            agoraClient.leave();
        }

    </script>
</body>
</html>
